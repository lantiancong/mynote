## File

java.io包下的类

> 功能:
>
> 文件信息
>
> 文件类型
>
> 创建/删除文件

![1](..\img\9-1.png)

# IO流

> 读写数据(文件,网络中的)

![1](..\img\9-2.png)

## 创建File对象

> 文件或文件夹

![1](..\img\9-3.png)

> 创建指向(封装路径)

![1](..\img\9-4.png)

## File常用方法

### 判断文件类型/获取文件信息

![1](..\img\9-5.png)

> 修改时间函数
>
> ![1](..\img\9-6.png)

### 创建/删除文件

![1](..\img\9-7.png)

![1](..\img\9-8.png)

### 遍历文件夹

![1](..\img\9-9.png)

> 注意事项
>
> ![1](..\img\9-10.png)

### 方法递归

```java
if(终止条件){
    return
}else{
    递归程序
}
```

```java
public static int f(int n){
    return n==1||n==0?1:f(n-1)*n;
}
```

## 文件搜索

![1](..\img\9-11.png)

[体现算法的重要性](https://www.bilibili.com/video/BV1Cv411372m?t=694.8&p=155)

![1](..\img\9-11-ex.png)

![1](..\img\9-11-ex2.png)

### 练习:删除非空文件夹

> 代码中用`dir.length() == 0`判断目录是否为空，但 **`length()`方法对目录无效 **（返回值始终为 0，与目录是否为空无关）。

---

## 字符集 ，编码等前置知识

### 字符集

> ASCII:一个字节,**首位为0**
>
> GBK:汉字两个字节,兼容ASCII(英文数字1字节),**首位为1**
>
> *所以可以混合解码*

> #### Unicode字符集(统一码,万国码)
>
> ***UTF-8:***
>
> ![1](..\img\9-12.png)
>
> ![1](..\img\9-12-ex.png)

基本兼容ASCII码,英文数字基本不乱码

![1](..\img\9-13.png)

> getBytes()按照当前编码格式编码
>
> [演示](https://www.bilibili.com/video/BV1Cv411372m?t=1900.9&p=156)
>
> ```java
> public class CharsetTest {
>     public static void main(String[] args) throws UnsupportedEncodingException {
>         String data="a我b";
>         byte[] bytes = data.getBytes();
>         System.out.println(Arrays.toString(bytes));
> 
>         byte[] bytes2=data.getBytes("GBK");
>         System.out.println(Arrays.toString(bytes2));
> 
>         String s1=new String(bytes);
>         System.out.println(s1);
> 
>         String s2=new String(bytes2,"GBK");
>         System.out.println(s2);
> 
>         String s3=new String(bytes,"GBK");
>         System.out.println(s3);
>     }
> }
> 
> ```
>
> 

## IO流-字节流

![1](..\img\9-14.png)

> 字节输入/输出流
>
> 字符输入/输出流

## InputStream

![1](..\img\9-15.png)

```java
InputStream is=new FileInputStream("路径");
int b1=is.read();//读取第一个字节
int b2=is.read();//读取第二个字节
//没有数据可读read()会返回-1
//读中文必定乱码
```

***必须关闭！！！***

is.close();

---

为防止中文乱码,所以一次性读取

```java
public class IOTest03 {
    public static void main(String[] args) throws IOException {
        InputStream is=new FileInputStream("src/resource/tian.txt");

        File f=new File("src/resource/tian.txt");
        //磁盘数据可能很大,用long接收
        long size=f.length();
        //byte[]最大到int,因为测试,所以直接强转
        byte[] b=new byte[(int) size];
        //记得读取,不然没数据
        int len=is.read(b);
        String str=new String(b);
        System.out.println(str);

        System.out.println(size);
        System.out.println(len);

        is.close();

    }
}
```

但是有一次性的方法

![1](..\img\9-16.png)



```java
public class IOTest03 {
    public static void main(String[] args) throws IOException {
        InputStream is=new FileInputStream("src/resource/tian.txt");
        
        //上面方法与此等效
        byte[] b=is.readAllBytes();
        System.out.println(new String(b));
        is.close();

    }
}
```

**但是依然有文件过大超出内存空间的可能**

---

## OutputStream

![1](..\img\9-17.png)

```java
public class IOTest04 {
    public static void main(String[] args) throws IOException {

        //加了true就是一个可追加的输出流,不然每次执行会刷新覆盖
        OutputStream os=new FileOutputStream("src/resource/cong.txt",true);

        os.write(97);
        os.write('b');
        byte[] b="兰天从兰天从abc".getBytes();
        os.write(b);
        os.write(b,0,9);
        os.write("\r\n".getBytes());
        os.flush();
        os.close();

    }
}

```

### 复制文件

![1](..\img\9-18.png)

```java
public class IOTest05 {
    public static void main(String[] args) throws IOException {
        File f1=new File("src/resource/img");
        System.out.println(f1.mkdir());

        File f2=new File("src/resource/img01");
        System.out.println(f2.mkdir());

        InputStream in=new FileInputStream(f1+"/9-18.png");
        OutputStream out=new FileOutputStream(f2+"/9-18.png");
        byte[] b=new byte[1024];
        while((in.read(b))!=-1){
            out.write(b);
        }

        out.close();
        in.close();
    }
}
```

---

## IO注意事项

![1](..\img\9-19.png)

**所以不要在finally中return**

**会被覆盖	!	!**

![1](..\img\9-20.png)

专业处理方式

![1](..\img\9-21.png)

## [try-with-resource](https://www.bilibili.com/video/BV1Cv411372m?t=1237.6&p=160)

![1](..\img\9-22.png)

---

## IO流-字符流

> java中的char采用Unicode编码(UTF-16),大部分2字节,少部分4字节
>
> C/C++中的char采用ASCII编码,占用1字节

## FileReader

和字节流差不多

![1](..\img\9-23.png)

```java
public class IOTest01 {
    public static void main(String[] args) {
        try (
                Reader fr = new FileReader("src/resource/tian.txt");

                ){
            char[] c=new char[3];
            while(fr.read(c)!=-1){
                System.out.print(new String(c));
        }
            }catch (Exception e) {
            throw new RuntimeException(e);
        }

    }
}
```

## FileWriter

![1](..\img\9-24.png)

![1](..\img\9-25.png)

> 因为存在缓冲区,先放到缓冲区,关闭或刷新时再一次性写入,优化性能
