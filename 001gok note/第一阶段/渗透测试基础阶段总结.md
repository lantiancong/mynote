# 渗透测试基础阶段总结

## 001 行业介绍

### 信息安全是什么

- 保护数据和数据载体的信息安全（技术 / 管理）

### 信息安全包含什么（根据不同领域划分）

- 网络安全
- WEB 安全
- 移动端安全
- 物联网安全
- 主机安全
- 云安全 ...

### 信息安全三要素（CIA）

- 机密性
- 完整性
- 可用性

### 信安行业的产业链

- 上游（基础技术支持、安全厂商）
- 中游（服务集成，集成商）
- 下游（直接客户（甲方），行业：金融、通信、交通、能源）

### 安全厂商头部企业

- 奇安信
- 深信服
- 安恒
- 长亭
- 绿盟

### 技术领域

- 攻击：渗透测试、红队评估
- 防守：安全服务、安全运维、安全运营
- 管理：安全管理、安全建设

### 行业认证

- CISP 认证体系

## 002 计算机基础

### 网络通信基础

#### 网络基本组成

网络设备（路由器、交换机、AF）、通信协议（TCP/IP）、介质（光纤、无线电）

#### 常见网络类型

互联 > 广域网 > 城域网 > 局域网

#### 网络通信模型

1. OSI 七层模型（了解各层次的作用）—— 结合 APP 发送消息案例
2. TCP/IP（四 / 五层）模型 —— 对比 OSI 七层进行理解

#### 数据通信过程

1. 协议数据单元 —— 数据在各层次不同叫法
2. 数据封装：应用层 —— 物理层
3. 数据解封装：物理层 —— 应用层

#### 常见网络协议

1. 应用层
   - 端口 | 服务 | 常见利用
2. 传输层
   - TCP
     - TCP 三次握手
     - TCP 四次挥手
   - UDP
3. 网络层
   - IP 协议（IPv4）
     - IPv4 地址组成
       - 点分十进制
       - 网络位 / 主机位 —— 子网掩码
     - IPv4 地址分类
       - A/B/C 类
       - 公 / 私 / 特殊地址（0.0.0.0/127.0.0.0/255.255.255.255/169.254.0.0）
   - ICMP 协议
4. 数据链路层
   - ARP 协议（MAC 地址）

### linux 操作系统基础

#### linux 文件系统

- /etc
- /home
- /var
- /tmp

#### linux shell 基础

- shell 终端开启
- 特殊符号
- 文件描述符

#### linux 基本操作

- 文件交互基础命令：ls、cd

#### linux 系统管理

1. 用户管理：
   - 用户查看
   - 用户切换
   - 用户密码修改
2. 文件权限管理：
   - 文件属性：10 位（1：文件类型：目录 / 文件 / 链接；2-4：文件所有者权限；5-7：组；8-10：其他用户）
   - 权限：RWX —— 读写执行 —— 二进制（421）
   - 文件权限更改：chmod
3. 文件内容管理：
   - VIM 工作模式：三种模式
   - 文本处理
4. 软件包管理：（APT）
   - 软件更新：sudo apt update /sudo apt upgrade
   - 软件安装：sudo apt install
5. 进程管理：
   - 进程查看：ps -ef /ps aux/top ——（PID）
   - 进程终止：kill -9 PID
6. 服务管理：
   - 服务单元管理
     - systemctl：systemctl start/status/restart/stop/enable/disable/list-units 服务单元
     - sysvinit： service 服务单元 start/status/restart/stop
7. 网络管理：
   - ip a
   - ifconfig
   - ss

### 虚拟化技术基础

- 将硬件虚拟化 —— 允许多台主机运行在宿主机

#### 虚拟化模式

- Type 1 Hypervisor（裸金属型）—— bios —— esxi
- Type 2 Hypervisor（托管型）—— bios —— window/linux —— vmware/box

#### 虚拟化工具

1. VMware workstation Pro
   - 虚拟网卡类型：仅主机 (VM1)、NAT（VM8）、桥接（VM0）
   - 虚拟机管理：创建 / 删除 / 启动 / 挂起 / 关闭
   - 快照管理：创建 / 还原 / 删除
   - VM tools ：宿主机 / 虚拟机之间进行文件共享
2. Docker
   - docker 基本命令：
     - 镜像：模板
       - docker images
       - docker pull [images]
       - docker run -it [images]
     - 容器：
       - docker ps
       - docker stop <container_id>
       - docker exec -it <container_id> bash/sh
   - docker-compsoe
     - docker-compose.yml docker compose 配置文件字段内容
     - docker-compose build => 拉去镜像
     - docker-compose up => 启动
     - docker-compose stop => 停止
     - docker-compose down => 停止并删除

### windows 基础

#### windows 文件结构

- C:\Windows
- C:$Recycle.Bin
- C:\Temp

#### windows 命令提示符 / PowerShell

- 常用命令：dir/cd
- 执行策略：
  - Set-ExecutionPolicy Bypass -Scope Process ：绕过当前 shell 执行策略

#### windows 系统管理

1. windows 文件系统管理
   - 权限设置 / 查看
2. window 服务管理
   - PS:Get-service
   - CMD：SC
     - 服务管理：start/stop/delete
3. windows 进程管理
   - 进程查看：tasklist
   - 进程终止：taskkill PID
4. windows 用户管理
   - SID 字段属性
   - 用户账号管理
     - 添加 / 删除
     - 用户组添加 / 删除
5. windows 网络管理
   - ipconfig /all
   - netstat -ano 端口

## 003 渗透测试流程

### 渗透测试模型

- 黑盒：无相关信息，侧重模拟黑客渗透
- 白盒：测试账号、源码，侧重代码层面功能安全性测试
- 灰盒：测试账号，业务功能安全性测试

### 渗透测试流程

1. 信息收集：
   - 主机信息收集：
     - 存活探测：nmap -sn ip/ip 段
     - 端口扫描：nmap -sS/-sT/-sY/-sA/-sU -p (-: 全端口 / 单个端口：21) ip/ip 段
     - 端口服务 / 系统版本：nmap -sV -O ip/ip 段
2. 漏洞扫描：
   - 安全配置扫描：nmap -sC -p 21 ip/IP 段
   - 漏洞脚本扫描：nmap --script=vuln -p 21 ip/ip 段
3. 漏洞验证：
   - 信息收集的信息分析 —— 服务版本
   - 未授权访问：匿名登陆
   - 用户口令爆破：SSH、FTP、Mysql 弱口令爆破
   - 系统漏洞利用：操作系统漏洞，WEB 应用系统
4. 权限获取：
   - shell 获取：
     - shell 类型：
       - 正向 shell
       - 反向 shell
       - webshell
   - shell 反弹命令
     - https://www.ddosi.org/shell/
     - 无交互 shell / 交互 shell
       - python 生成交互 shell：python -c "import pty; pty.spawn ('/bin/bash')"
5. 权限提升：
   - 用户密码破解
     - /etc/passwd
     - /etc/shadow
   - sudo 提权
     - 查看当前用户是否在 sudo 组，sudo -l
     - https://gtfobins.github.io/
   - suid 提权
     - find / -perm -u=s -type f 2>/dev/null
   - 定时任务提权
     - crontab -l
     - crontab -e
     - /etc/cron.d/ 系统级定时任务是否存在当前用户可写文件
   - 内核提权
     - 查看内核版本
     - 查询对应内核版本漏洞脚本
6. 报告编写：

## 004 网络安全

### 常见协议 / 服务

1. Telnet 端口 利用
2. SSH 端口 利用
3. FTP 端口 利用
   - 匿名登录
   - FTP 版本漏洞
4. SMB 端口 利用
   - MS12-020
   - MS17-010
5. HTTP 端口
   - 协议组成
   - 请求 / 响应